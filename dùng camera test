from ultralytics import YOLO
import cv2

# 1. Load model từ file best.pt
model = YOLO(r"D:\Robotic\best.pt")

# 2. Mở webcam
cap = cv2.VideoCapture(0)

while True:
    ret, frame = cap.read()
    if not ret:
        print("Không thể mở camera")
        break

    # 3. Dò tìm object với confidence threshold và NMS
    results = model.predict(
        frame, 
        conf=0.5,      # Chỉ hiện detections có confidence >= 60%
        iou=0.4,      # NMS threshold - loại bỏ boxes trùng lặp
        verbose=False  # Tắt log
    )

    # 4. Vẽ kết quả lên frame
    for result in results:
        annotated_frame = result.plot()
        cv2.imshow("YOLOv8 Webcam Test", annotated_frame)

    # 5. Nhấn 'q' để thoát
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
